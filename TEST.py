import os
import time
from telegram import Update, InlineKeyboardButton, InlineKeyboardMarkup, InputMediaPhoto
from telegram.ext import ContextTypes
import dbconnect

# –ü–æ–ª—É—á–∞–µ–º –∞–±—Å–æ–ª—é—Ç–Ω—ã–π –ø—É—Ç—å –∫ –ø–∞–ø–∫–µ –ø—Ä–æ–µ–∫—Ç–∞
BASE_DIR = os.path.dirname(os.path.abspath(__file__))
PICTURES_DIR = os.path.join(BASE_DIR, "Pictures")

# –°–ª–æ–≤–∞—Ä–∏ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
user_states = {}
user_scores = {}
user_start_time = {}

# –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏–≥—Ä—ã —Å –ø–æ–ª–Ω—ã–º –Ω–∞–±–æ—Ä–æ–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
game_structure = {
    "start": {
        "text": "üè† –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –ø—Ä–∏—é—Ç –õ–∞–ø–∫–∏ –¥–æ–±—Ä–∞!\n\n–Ø –ê–Ω–Ω–∞ - —Ç–≤–æ–π –≥–∏–¥ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è.\n–í—ã–±–µ—Ä–∏, —Å —á–µ–≥–æ –Ω–∞—á–Ω–µ—à—å:",
        "image": os.path.join(PICTURES_DIR, "Pic1.png"),
        "options": [
            {"text": "–ë—ã—Å—Ç—Ä—ã–π –∏–Ω—Å—Ç—Ä—É–∫—Ç–∞–∂ (2 –º–∏–Ω—É—Ç—ã)", "next": "instruction", 
             "skills": {"–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å": 5, "–≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å": 3}},
            {"text": "–°—Ä–∞–∑—É –∫ –∂–∏–≤–æ—Ç–Ω—ã–º", "next": "animals", 
             "skills": {"–∏–Ω–∏—Ü–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å": 5, "—Å–º–µ–ª–æ—Å—Ç—å": 3}},
            {"text": "–ü–æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –∫–æ–º–∞–Ω–¥–æ–π", "next": "team", 
             "skills": {"–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è": 5, "—Ä–∞–±–æ—Ç–∞_–≤_–∫–æ–º–∞–Ω–¥–µ": 3}}
        ]
    },
    "instruction": {
        "text": "üìã –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞:\n‚Ä¢ –ù–µ –∑–∞—Ö–æ–¥–∏ –≤ –≤–æ–ª—å–µ—Ä—ã –æ–¥–∏–Ω\n‚Ä¢ –ù–µ –∫–æ—Ä–º–∏ –±–µ–∑ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è\n‚Ä¢ –°–æ–æ–±—â–∞–π –æ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å—Ä–∞–∑—É\n\n–ì–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ! +5 –∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏",
        "next": "task_selection"
    },
    "animals": {
        "text": "‚úÖ –ë—ã—Å—Ç—Ä–µ–µ –Ω–∞—á–∏–Ω–∞–µ—à—å —Ä–∞–±–æ—Ç–∞—Ç—å\n‚úÖ +5 –∫ –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏\n‚ùå –†–∏—Å–∫—É–µ—à—å —Å–¥–µ–ª–∞—Ç—å –æ—à–∏–±–∫–∏",
        "next": "task_selection"
    },
    "team": {
        "text": "‚úÖ +5 –∫ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏\n‚úÖ –ü–æ–ª—É—á–∞–µ—à—å —Å–æ–≤–µ—Ç—ã –æ—Ç –æ–ø—ã—Ç–Ω—ã—Ö\n‚ùå –ú–µ–Ω—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –∑–∞–¥–∞—á–∏",
        "next": "task_selection"
    },
    "task_selection": {
        "text": "üéØ –ù–∞ —Å–µ–≥–æ–¥–Ω—è 4 –æ—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏:\n\n1. –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –≤–æ–ª—å–µ—Ä—ã –∫ —ç–∫—Å–∫—É—Ä—Å–∏–∏\n2. –í—ã–≥—É–ª—è—Ç—å —Å–æ–±–∞–∫ –∏–∑ –∫–∞—Ä–∞–Ω—Ç–∏–Ω–∞\n3. –ü–æ–º—ã—Ç—å –º–∏—Å–∫–∏ –∏ —É–±—Ä–∞—Ç—å—Å—è\n4. –ü–æ–º–æ—á—å –≤–µ—Ç–µ—Ä–∏–Ω–∞—Ä—É\n\n–í—ã–±–µ—Ä–∏ –Ω–æ–º–µ—Ä –∑–∞–¥–∞—á–∏:",
        "image": os.path.join(PICTURES_DIR, "Pic2.png"),
        "options": [
            {"text": "1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –≤–æ–ª—å–µ—Ä–æ–≤", "next": "task1", 
             "skills": {"—Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ": 10, "–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å": 5, "–≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å": 3}},
            {"text": "2. –í—ã–≥—É–ª —Å–æ–±–∞–∫", "next": "task2", 
             "skills": {"—ç–º–ø–∞—Ç–∏—è": 10, "—Ç–µ—Ä–ø–µ–Ω–∏–µ": 5, "–∞–Ω–∞–ª–∏–∑": 3}},
            {"text": "3. –£–±–æ—Ä–∫–∞", "next": "task3", 
             "skills": {"–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å": 10, "–≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å": 5, "—Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ": 3}},
            {"text": "4. –ü–æ–º–æ—â—å –≤–µ—Ç–µ—Ä–∏–Ω–∞—Ä—É", "next": "task4", 
             "skills": {"–º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ_–Ω–∞–≤—ã–∫–∏": 10, "–∞–Ω–∞–ª–∏–∑": 5, "—Ç–µ—Ä–ø–µ–Ω–∏–µ": 3}}
        ]
    },
    "task1": {
        "text": "‚úÖ +10 –∫ —Ç–≤–æ—Ä—á–µ—Å—Ç–≤—É\n‚úÖ –í–∏–¥–∏—à—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å—Ä–∞–∑—É\n‚ùå –ú–Ω–æ–≥–æ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π —Ä–∞–±–æ—Ç—ã", 
        "next": "animals_selection"
    },
    "task2": {
        "text": "‚úÖ +10 –∫ —ç–º–ø–∞—Ç–∏–∏\n‚úÖ –ü—Ä—è–º–æ–π –∫–æ–Ω—Ç–∞–∫—Ç —Å –∂–∏–≤–æ—Ç–Ω—ã–º–∏\n‚ùå –†–∏—Å–∫ —Å—Ç—Ä–µ—Å—Å–æ–≤—ã—Ö —Å–∏—Ç—É–∞—Ü–∏–π", 
        "next": "animals_selection"
    },
    "task3": {
        "text": "‚úÖ +10 –∫ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏\n‚úÖ –í–∞–∂–Ω–∞—è, –Ω–æ –ø—Ä–æ—Å—Ç–∞—è —Ä–∞–±–æ—Ç–∞\n‚ùå –ú–∞–ª–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –∂–∏–≤–æ—Ç–Ω—ã–º–∏", 
        "next": "animals_selection"
    },
    "task4": {
        "text": "‚úÖ +10 –∫ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–º –Ω–∞–≤—ã–∫–∞–º\n‚úÖ –£—á–∏—à—å—Å—è –Ω–æ–≤–æ–º—É\n‚ùå –í—ã—Å–æ–∫–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å", 
        "next": "animals_selection"
    },
    "animals_selection": {
        "text": "üêï –í –∫–∞—Ä–∞–Ω—Ç–∏–Ω–µ 3 —Å–æ–±–∞–∫–∏:\n\n1. –ì—Ä–µ–π - –ø—É–≥–ª–∏–≤—ã–π, –Ω—É–∂–¥–∞–µ—Ç—Å—è –≤ –ª–∞—Å–∫–µ\n2. –ë–∞—Ä—Å - —Å–µ—Ä—å–µ–∑–Ω—ã–π, —Ç—Ä–µ–±—É–µ—Ç –æ–ø—ã—Ç–∞\n3. –õ—é—Å–∏ - –¥–æ–±—Ä–∞—è, –∏–¥–µ–∞–ª—å–Ω–∞ –¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤\n\n–ö–æ–≥–æ –≤—ã–±–µ—Ä–µ—à—å?",
        "image": os.path.join(PICTURES_DIR, "Pic3.jpg"),
        "options": [
            {"text": "1. –ì—Ä–µ–π (–ø—É–≥–ª–∏–≤—ã–π)", "next": "animal1", 
             "skills": {"—ç–º–ø–∞—Ç–∏—è": 15, "—Ç–µ—Ä–ø–µ–Ω–∏–µ": 8, "–≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å": 5, "–∞–Ω–∞–ª–∏–∑": 3}},
            {"text": "2. –ë–∞—Ä—Å (—Å–µ—Ä—å–µ–∑–Ω—ã–π)", "next": "animal2", 
             "skills": {"—Å–º–µ–ª–æ—Å—Ç—å": 12, "–∏–Ω–∏—Ü–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å": 8, "–∞–Ω–∞–ª–∏–∑": 5}, 
             "risk": {"–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å": -5}},
            {"text": "3. –õ—é—Å–∏ (–¥–æ–±—Ä–∞—è)", "next": "animal3", 
             "skills": {"—É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å": 10, "–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è": 8, "—Ä–∞–±–æ—Ç–∞_–≤_–∫–æ–º–∞–Ω–¥–µ": 5}}
        ]
    },
    "animal1": {
        "text": "‚úÖ +15 –∫ —ç–º–ø–∞—Ç–∏–∏\n‚úÖ –£—á–∏—à—å—Å—è —Ç–µ—Ä–ø–µ–Ω–∏—é\n‚ùå –ú–µ–¥–ª–µ–Ω–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å", 
        "next": "emergency"
    },
    "animal2": {
        "text": "‚úÖ +10 –∫ —Å–º–µ–ª–æ—Å—Ç–∏\n‚úÖ –¶–µ–Ω–Ω—ã–π –æ–ø—ã—Ç\n‚ùå -5 –∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (—Ä–∏—Å–∫)", 
        "next": "emergency"
    },
    "animal3": {
        "text": "‚úÖ +10 –∫ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏\n‚úÖ –ë—ã—Å—Ç—Ä—ã–π —É—Å–ø–µ—Ö\n‚ùå –ú–∞–ª–æ –Ω–æ–≤–æ–≥–æ —É–∑–Ω–∞–µ—à—å", 
        "next": "emergency"
    },
    "emergency": {
        "text": "‚ö†Ô∏è –û–¥–Ω–∞ —Å–æ–±–∞–∫–∞ –Ω–∞—á–∞–ª–∞ –¥—Ä–∞—Ç—å—Å—è!\n\n–¢–≤–æ–∏ –¥–µ–π—Å—Ç–≤–∏—è:",
        "image": os.path.join(PICTURES_DIR, "Pic4.jpg"),
        "options": [
            {"text": "–ü–æ–∑–≤–∞—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä–∞", "next": "emergency1", 
             "skills": {"–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å": 15, "—Ä–∞–±–æ—Ç–∞_–≤_–∫–æ–º–∞–Ω–¥–µ": 8, "–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å": 5}, 
             "risk": {"—Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å": -5}},
            {"text": "–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —É—Å–ø–æ–∫–æ–∏—Ç—å —Å–∞–º–æ–º—É", "next": "emergency2", 
             "skills": {"—Å–º–µ–ª–æ—Å—Ç—å": 12, "–æ–ø—ã—Ç": 8, "–∏–Ω–∏—Ü–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å": 5, "–∞–Ω–∞–ª–∏–∑": 3}, 
             "risk": {"–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å": -10}},
            {"text": "–û—Ç–æ–π—Ç–∏ –∏ –Ω–∞–±–ª—é–¥–∞—Ç—å", "next": "emergency3", 
             "skills": {"–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç—å": 8, "–≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å": 5, "–∞–Ω–∞–ª–∏–∑": 3}, 
             "risk": {"–∏–Ω–∏—Ü–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å": -10}}
        ]
    },
    "emergency1": {
        "text": "‚úÖ +15 –∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏\n‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ\n‚ùå -5 –∫ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏", 
        "next": "children"
    },
    "emergency2": {
        "text": "‚úÖ +10 –∫ —Å–º–µ–ª–æ—Å—Ç–∏\n‚úÖ +5 –∫ –æ–ø—ã—Ç—É\n‚ùå -10 –∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (—Ä–∏—Å–∫)", 
        "next": "children"
    },
    "emergency3": {
        "text": "‚úÖ +5 –∫ –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç–∏\n‚úÖ –ù–∏—á–µ–≥–æ –Ω–µ –∏—Å–ø–æ—Ä—Ç–∏—à—å\n‚ùå -10 –∫ –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏", 
        "next": "children"
    },
    "children": {
        "text": "üëß –ü—Ä–∏—à–ª–∏ —à–∫–æ–ª—å–Ω–∏–∫–∏. –û–¥–∏–Ω —Ä–µ–±–µ–Ω–æ–∫ —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç:\n–ú–æ–∂–Ω–æ –ø–æ–≥–ª–∞–¥–∏—Ç—å —ç—Ç—É —Å–æ–±–∞–∫—É?\n\n–¢–≤–æ–π –æ—Ç–≤–µ—Ç:",
        "image": os.path.join(PICTURES_DIR, "Pic5.jpg"),
        "options": [
            {"text": "–î–∞, –æ–Ω–∞ –æ—á–µ–Ω—å –¥–æ–±—Ä–∞—è", "next": "children1", 
             "skills": {"–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è": 8, "—ç–º–ø–∞—Ç–∏—è": 5, "—Ä–∞–±–æ—Ç–∞_–≤_–∫–æ–º–∞–Ω–¥–µ": 3}, 
             "risk": {"–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å": -10}},
            {"text": "–°–Ω–∞—á–∞–ª–∞ —Å–ø—Ä–æ—Å–∏ —É –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä–∞", "next": "children2", 
             "skills": {"–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å": 12, "–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å": 8, "—Ä–∞–±–æ—Ç–∞_–≤_–∫–æ–º–∞–Ω–¥–µ": 5}},
            {"text": "–õ—É—á—à–µ –ø–æ—Å–º–æ—Ç—Ä–∏ –ø–æ–∫–∞ –∏–∑–¥–∞–ª–µ–∫–∞", "next": "children3", 
             "skills": {"–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç—å": 8, "–≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å": 5, "–∞–Ω–∞–ª–∏–∑": 3}, 
             "risk": {"–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è": -8}}
        ]
    },
    "children1": {
        "text": "‚úÖ –î–µ—Ç–∏ –¥–æ–≤–æ–ª—å–Ω—ã\n‚úÖ +5 –∫ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏\n‚ùå -10 –∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (—Ä–∏—Å–∫)", 
        "next": "results"
    },
    "children2": {
        "text": "‚úÖ +10 –∫ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏\n‚úÖ –í—Å–µ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏\n‚ùå –î–µ—Ç–∏ –Ω–µ–º–Ω–æ–≥–æ —Ä–∞–∑–æ—á–∞—Ä–æ–≤–∞–Ω—ã", 
        "next": "results"
    },
    "children3": {
        "text": "‚úÖ +5 –∫ –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç–∏\n‚úÖ –°–æ–±–∞–∫–∞ –≤ —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏–∏\n‚ùå -5 –∫ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏", 
        "next": "results"
    }
}

async def start_game(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """–ù–∞—á–∞–ª–æ –∏–≥—Ä—ã"""
    query = update.callback_query
    user_id = query.from_user.id
    
    # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ –∏–≥—Ä—ã
    user_start_time[user_id] = time.time()
    
    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –≤—Å–µ –Ω–∞–≤—ã–∫–∏ —Å –Ω—É–ª—è
    user_states[user_id] = "start"
    user_scores[user_id] = {
        "–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å": 0, "–∏–Ω–∏—Ü–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å": 0, "–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è": 0, "—Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ": 0,
        "—ç–º–ø–∞—Ç–∏—è": 0, "–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å": 0, "–º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ_–Ω–∞–≤—ã–∫–∏": 0, "—Ç–µ—Ä–ø–µ–Ω–∏–µ": 0,
        "—Å–º–µ–ª–æ—Å—Ç—å": 0, "—É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å": 0, "–æ–ø—ã—Ç": 0, "–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç—å": 0,
        "—Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å": 0, "–≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å": 0, "–∞–Ω–∞–ª–∏–∑": 0, "—Ä–∞–±–æ—Ç–∞_–≤_–∫–æ–º–∞–Ω–¥–µ": 0
    }
    
    await send_step(update, context, user_id)

async def send_step(update: Update, context: ContextTypes.DEFAULT_TYPE, user_id: int):
    """–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–µ–∫—É—â–∏–π —à–∞–≥ –∏–≥—Ä—ã —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –µ—Å–ª–∏ –µ—Å—Ç—å"""
    current_state = user_states[user_id]
    step_data = game_structure[current_state]
    
    keyboard = []
    
    if "options" in step_data:
        for option in step_data["options"]:
            keyboard.append([InlineKeyboardButton(option["text"], callback_data=option["next"])])
    else:
        keyboard.append([InlineKeyboardButton("‚û°Ô∏è –î–∞–ª—å—à–µ", callback_data=step_data["next"])])
    
    # –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –≤—ã—Ö–æ–¥–∞ –≤ –º–µ–Ω—é
    keyboard.append([InlineKeyboardButton("üè† –í –º–µ–Ω—é", callback_data="menu")])
    
    try:
        # –ï—Å–ª–∏ –µ—Å—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –µ–≥–æ —Å —Ç–µ–∫—Å—Ç–æ–º
        if "image" in step_data:
            image_path = step_data["image"]
            try:
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞
                if os.path.exists(image_path):
                    with open(image_path, 'rb') as photo:
                        await update.callback_query.edit_message_media(
                            media=InputMediaPhoto(photo, caption=step_data["text"]),
                            reply_markup=InlineKeyboardMarkup(keyboard)
                        )
                else:
                    print(f"–§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω: {image_path}")
                    # –ï—Å–ª–∏ —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç
                    await update.callback_query.edit_message_text(
                        step_data["text"],
                        reply_markup=InlineKeyboardMarkup(keyboard)
                    )
            except Exception as e:
                print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è {image_path}: {e}")
                await update.callback_query.edit_message_text(
                    step_data["text"],
                    reply_markup=InlineKeyboardMarkup(keyboard)
                )
        else:
            # –ï—Å–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–µ—Ç, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç
            await update.callback_query.edit_message_text(
                step_data["text"],
                reply_markup=InlineKeyboardMarkup(keyboard)
            )
    except Exception as e:
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —à–∞–≥–∞: {e}")
        # –ï—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–æ–≤–æ–µ
        try:
            if "image" in step_data and os.path.exists(step_data["image"]):
                with open(step_data["image"], 'rb') as photo:
                    await update.callback_query.message.reply_photo(
                        photo=photo,
                        caption=step_data["text"],
                        reply_markup=InlineKeyboardMarkup(keyboard)
                    )
            else:
                await update.callback_query.message.reply_text(
                    step_data["text"],
                    reply_markup=InlineKeyboardMarkup(keyboard)
                )
        except Exception as e2:
            print(f"–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: {e2}")

async def handle_choice(update: Update, context: ContextTypes.DEFAULT_TYPE, user_id: int, next_step: str):
    """–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—ã–±–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
    try:
        current_state = user_states[user_id]
        step_data = game_structure[current_state]
        
        # –û–±–Ω–æ–≤–ª—è–µ–º –Ω–∞–≤—ã–∫–∏, –µ—Å–ª–∏ –µ—Å—Ç—å
        if "options" in step_data:
            for option in step_data["options"]:
                if option["next"] == next_step:
                    if "skills" in option:
                        for skill, value in option["skills"].items():
                            # –î–æ–±–∞–≤–ª—è–µ–º –Ω–∞–≤—ã–∫–∏ –∫ —Ç–µ–∫—É—â–∏–º –∑–Ω–∞—á–µ–Ω–∏—è–º
                            user_scores[user_id][skill] = user_scores[user_id].get(skill, 0) + value
                    if "risk" in option:
                        for skill, value in option["risk"].items():
                            # –í—ã—á–∏—Ç–∞–µ–º —Ä–∏—Å–∫–∏ –∏–∑ —Ç–µ–∫—É—â–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π
                            user_scores[user_id][skill] = user_scores[user_id].get(skill, 0) + value
                    break
        
        # –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —à–∞–≥—É
        user_states[user_id] = next_step
        
        if next_step == "results":
            await show_results(update, context, user_id)
        else:
            await send_step(update, context, user_id)
            
    except Exception as e:
        print(f"–û—à–∏–±–∫–∞ –≤ handle_choice: {e}")
        await update.callback_query.answer("–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.", show_alert=True)

async def show_results(update: Update, context: ContextTypes.DEFAULT_TYPE, user_id: int):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–∏–ø –≤–æ–ª–æ–Ω—Ç–µ—Ä–∞"""
    try:
        # –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        if user_id not in user_scores:
            print(f"–û—à–∏–±–∫–∞: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {user_id} –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ user_scores")
            await update.callback_query.edit_message_text(
                "üéâ –ò–≥—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –°–ø–∞—Å–∏–±–æ –∑–∞ —É—á–∞—Å—Ç–∏–µ!",
                reply_markup=InlineKeyboardMarkup([
                    [InlineKeyboardButton("üéÆ –í –º–µ–Ω—é", callback_data="menu")]
                ])
            )
            return
        
        scores = user_scores[user_id]
        print(f"DEBUG: –ù–∞–≤—ã–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {user_id}: {scores}")  # –î–ª—è –æ—Ç–ª–∞–¥–∫–∏
        
        # –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –≤—Ä–µ–º—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è
        game_duration = None
        if user_id in user_start_time:
            game_duration = int(time.time() - user_start_time[user_id])
            # –£–¥–∞–ª—è–µ–º –≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞
            del user_start_time[user_id]
        
        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –≤–æ–ª–æ–Ω—Ç–µ—Ä–∞
        try:
            volunteer_type = determine_volunteer_type(scores)
            print(f"DEBUG: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π —Ç–∏–ø –≤–æ–ª–æ–Ω—Ç–µ—Ä–∞: {volunteer_type['type']}")  # –î–ª—è –æ—Ç–ª–∞–¥–∫–∏
        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ —Ç–∏–ø–∞ –≤–æ–ª–æ–Ω—Ç–µ—Ä–∞: {e}")
            volunteer_type = get_volunteer_description("–ù–∞—á–∏–Ω–∞—é—â–∏–π –≤–æ–ª–æ–Ω—Ç–µ—Ä")
        
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
        query = update.callback_query
        username = query.from_user.username
        first_name = query.from_user.first_name
        last_name = query.from_user.last_name
        
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
        try:
            await dbconnect.save_results(
                user_id=user_id,
                volunteer_type=volunteer_type["type"],
                scores=scores,
                game_duration=game_duration,
                username=username,
                first_name=first_name,
                last_name=last_name
            )
            print(f"DEBUG: –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –ë–î –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {user_id}")
        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –≤ –ë–î: {e}")
        
        # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –≤—Ä–µ–º—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
        time_display = "–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"
        if game_duration:
            minutes = game_duration // 60
            seconds = game_duration % 60
            time_display = f"{minutes} –º–∏–Ω {seconds} —Å–µ–∫"
        
        # –°–æ–∑–¥–∞–µ–º —Ç–µ–∫—Å—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        result_text = f"üèÜ –í–ê–® –†–ï–ó–£–õ–¨–¢–ê–¢\n\n–í—ã - {volunteer_type['type']}!\n\n"
        result_text += f"{volunteer_type['description']}\n\n"
        result_text += f"‚è± –í—Ä–µ–º—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è: {time_display}\n\n"
        result_text += "üìä –í–∞—à–∏ –Ω–∞–≤—ã–∫–∏:\n"
        
        # –°–æ—Ä—Ç–∏—Ä—É–µ–º –Ω–∞–≤—ã–∫–∏ –ø–æ —É–±—ã–≤–∞–Ω–∏—é –∑–Ω–∞—á–µ–Ω–∏—è
        sorted_skills = sorted(scores.items(), key=lambda x: x[1], reverse=True)
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –Ω–∞–≤—ã–∫–∏ —Å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
        displayed_count = 0
        for skill, value in sorted_skills:
            if value > 0:
                # –û–ø—Ä–µ–¥–µ–ª—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –Ω–∞–≤—ã–∫ –æ—Å–Ω–æ–≤–Ω—ã–º –¥–ª—è —ç—Ç–æ–≥–æ —Ç–∏–ø–∞
                is_main = skill in volunteer_type.get('main_skills', [])
                emoji = "üåü" if is_main else "‚Ä¢"
                skill_display = skill.capitalize().replace("_", " ")
                result_text += f"{emoji} {skill_display}: {value}\n"
                displayed_count += 1
                if displayed_count >= 8:  # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º—ã—Ö –Ω–∞–≤—ã–∫–æ–≤
                    break
        
        result_text += f"\n{volunteer_type['recommendations']}"
        
        # –û–±—Ä–µ–∑–∞–µ–º —Ç–µ–∫—Å—Ç –µ—Å–ª–∏ —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–π
        if len(result_text) > 3000:
            result_text = result_text[:3000] + "..."
        
        keyboard = [
            [InlineKeyboardButton("üéÆ –í—ã–±—Ä–∞—Ç—å –¥—Ä—É–≥—É—é –∏–≥—Ä—É", callback_data="menu")],
            [InlineKeyboardButton("üîÑ –ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞", callback_data="game2")]
        ]
        
        await update.callback_query.edit_message_text(
            result_text,
            reply_markup=InlineKeyboardMarkup(keyboard)
        )
        
        # –û—á–∏—â–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ—Å–ª–µ –ø–æ–∫–∞–∑–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        if user_id in user_states:
            del user_states[user_id]
        if user_id in user_scores:
            del user_scores[user_id]
        
    except Exception as e:
        print(f"–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –≤ show_results: {e}")
        import traceback
        traceback.print_exc()
        await update.callback_query.edit_message_text(
            "üéâ –ò–≥—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –°–ø–∞—Å–∏–±–æ –∑–∞ —É—á–∞—Å—Ç–∏–µ!",
            reply_markup=InlineKeyboardMarkup([
                [InlineKeyboardButton("üéÆ –í –º–µ–Ω—é", callback_data="menu")]
            ])
        )

def determine_volunteer_type(scores):
    """–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–∏–ø –≤–æ–ª–æ–Ω—Ç–µ—Ä–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—É–º–º—ã —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫"""
    
    # –í—ã—á–∏—Å–ª—è–µ–º —Å—É–º–º—ã –¥–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
    protector_sum = scores.get("–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å", 0) + scores.get("–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å", 0)
    brave_sum = scores.get("–∏–Ω–∏—Ü–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å", 0) + scores.get("—Å–º–µ–ª–æ—Å—Ç—å", 0)
    empathy_sum = scores.get("—ç–º–ø–∞—Ç–∏—è", 0) + scores.get("—Ç–µ—Ä–ø–µ–Ω–∏–µ", 0)
    team_sum = scores.get("–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è", 0) + scores.get("—Ä–∞–±–æ—Ç–∞_–≤_–∫–æ–º–∞–Ω–¥–µ", 0)
    observer_sum = scores.get("–≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å", 0) + scores.get("–∞–Ω–∞–ª–∏–∑", 0)
    
    # –°–æ–∑–¥–∞–µ–º —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å—É–º–º –¥–ª—è –ø–æ–∏—Å–∫–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π
    type_sums = {
        "–û—Å—Ç–æ—Ä–æ–∂–Ω—ã–π –∑–∞—â–∏—Ç–Ω–∏–∫": protector_sum,
        "–°–º–µ–ª—ã–π –ø–æ–º–æ—â–Ω–∏–∫": brave_sum,
        "–≠–º–ø–∞—Ç–∏—á–Ω—ã–π –¥—Ä—É–≥": empathy_sum,
        "–ö–æ–º–∞–Ω–¥–Ω—ã–π –∏–≥—Ä–æ–∫": team_sum,
        "–í–Ω–∏–º–∞—Ç–µ–ª—å–Ω—ã–π –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª—å": observer_sum
    }
    
    # –ù–∞—Ö–æ–¥–∏–º —Ç–∏–ø —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å—É–º–º–æ–π
    max_type = max(type_sums, key=type_sums.get)
    max_sum = type_sums[max_type]
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –¥–æ—Å—Ç–∏–≥–Ω—É—Ç –ª–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø–æ—Ä–æ–≥ (18)
    if max_sum >= 18:
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ª–∏ –≤—ã—Å–æ–∫–∏ –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –Ω–∞–≤—ã–∫–∏ –¥–ª—è –û–ø—ã—Ç–Ω–æ–≥–æ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–∞
        all_skills_high = all(
            scores.get(skill, 0) >= 15 
            for skill in ["–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å", "–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å", "–∏–Ω–∏—Ü–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å", 
                         "—Å–º–µ–ª–æ—Å—Ç—å", "—ç–º–ø–∞—Ç–∏—è", "—Ç–µ—Ä–ø–µ–Ω–∏–µ", "–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è", 
                         "—Ä–∞–±–æ—Ç–∞_–≤_–∫–æ–º–∞–Ω–¥–µ", "–≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å", "–∞–Ω–∞–ª–∏–∑"]
            if scores.get(skill, 0) > 0  # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ–ª—å–∫–æ —Ç–µ –Ω–∞–≤—ã–∫–∏, —á—Ç–æ –±—ã–ª–∏ –Ω–∞–±—Ä–∞–Ω—ã
        )
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Ö–æ—Ç—è –±—ã 5 –Ω–∞–≤—ã–∫–æ–≤ —Å –≤—ã—Å–æ–∫–∏–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
        high_skills_count = sum(1 for skill, value in scores.items() if value >= 15)
        
        if all_skills_high and high_skills_count >= 5:
            return get_volunteer_description("–û–ø—ã—Ç–Ω—ã–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä")
        else:
            return get_volunteer_description(max_type)
    else:
        return get_volunteer_description("–ù–∞—á–∏–Ω–∞—é—â–∏–π –≤–æ–ª–æ–Ω—Ç–µ—Ä")

def get_volunteer_description(type_name):
    """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è —Ç–∏–ø–∞ –≤–æ–ª–æ–Ω—Ç–µ—Ä–∞"""
    descriptions = {
        "–û—Å—Ç–æ—Ä–æ–∂–Ω—ã–π –∑–∞—â–∏—Ç–Ω–∏–∫": {
            "type": "üõ°Ô∏è –û–°–¢–û–†–û–ñ–ù–´–ô –ó–ê–©–ò–¢–ù–ò–ö",
            "description": "–¢—ã - –Ω–∞–¥–µ–∂–Ω–∞—è –æ–ø–æ—Ä–∞ –ø—Ä–∏—é—Ç–∞! –ñ–∏–≤–æ—Ç–Ω—ã–µ —á—É–≤—Å—Ç–≤—É—é—Ç —Ç–≤–æ—é —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏ —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ.",
            "main_skills": ["–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å", "–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å", "–≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å"],
            "recommendations": "üéÅ –¢–µ–±–µ –ø–æ–¥–æ–π–¥–µ—Ç:\n‚Ä¢ –ö—É—Ä–∞—Ç–æ—Ä—Å—Ç–≤–æ –Ω–∞–¥ –Ω–æ–≤–∏—á–∫–∞–º–∏\n‚Ä¢ –†–∞–±–æ—Ç–∞ —Å –∂–∏–≤–æ—Ç–Ω—ã–º–∏-–∏–Ω–≤–∞–ª–∏–¥–∞–º–∏\n‚Ä¢ –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∑–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é"
        },
        "–°–º–µ–ª—ã–π –ø–æ–º–æ—â–Ω–∏–∫": {
            "type": "üî• –°–ú–ï–õ–´–ô –ü–û–ú–û–©–ù–ò–ö", 
            "description": "–¢—ã - –≥–µ—Ä–æ–π –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–∏—Ç—É–∞—Ü–∏–π! –ö–æ–≥–¥–∞ –¥—Ä—É–≥–∏–µ —Ç–µ—Ä—è—é—Ç—Å—è, —Ç—ã –¥–µ–π—Å—Ç–≤—É–µ—à—å.",
            "main_skills": ["—Å–º–µ–ª–æ—Å—Ç—å", "–∏–Ω–∏—Ü–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å", "–∞–Ω–∞–ª–∏–∑"],
            "recommendations": "üéÅ –¢–µ–±–µ –ø–æ–¥–æ–π–¥–µ—Ç:\n‚Ä¢ –°–ø–∞—Å–µ–Ω–∏–µ –∂–∏–≤–æ—Ç–Ω—ã—Ö –∏–∑ —Ç—Ä—É–¥–Ω–æ–¥–æ—Å—Ç—É–ø–Ω—ã—Ö –º–µ—Å—Ç\n‚Ä¢ –†–∞–±–æ—Ç–∞ —Å –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–º–∏ —Å–ª—É—á–∞—è–º–∏\n‚Ä¢ –≠–∫—Å—Ç—Ä–µ–Ω–Ω—ã–µ –≤—ã–∑–æ–≤—ã"
        },
        "–≠–º–ø–∞—Ç–∏—á–Ω—ã–π –¥—Ä—É–≥": {
            "type": "üíù –≠–ú–ü–ê–¢–ò–ß–ù–´–ô –î–†–£–ì",
            "description": "–¢—ã - —Å–µ—Ä–¥—Ü–µ –ø—Ä–∏—é—Ç–∞! –¢—ã –ø–æ–Ω–∏–º–∞–µ—à—å –∂–∏–≤–æ—Ç–Ω—ã—Ö –±–µ–∑ —Å–ª–æ–≤.",
            "main_skills": ["—ç–º–ø–∞—Ç–∏—è", "—Ç–µ—Ä–ø–µ–Ω–∏–µ", "–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è"],
            "recommendations": "üéÅ –¢–µ–±–µ –ø–æ–¥–æ–π–¥–µ—Ç:\n‚Ä¢ –†–µ–∞–±–∏–ª–∏—Ç–∞—Ü–∏—è —Ç—Ä–∞–≤–º–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∂–∏–≤–æ—Ç–Ω—ã—Ö\n‚Ä¢ –°–æ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∏–∫–∏—Ö –∏ –ø—É–≥–ª–∏–≤—ã—Ö –ø–∏—Ç–æ–º—Ü–µ–≤\n‚Ä¢ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∂–∏–≤–æ—Ç–Ω—ã—Ö –∫ –ø–µ—Ä–µ—Ö–æ–¥—É –≤ –Ω–æ–≤—ã–µ —Å–µ–º—å–∏"
        },
        "–ö–æ–º–∞–Ω–¥–Ω—ã–π –∏–≥—Ä–æ–∫": {
            "type": "üë• –ö–û–ú–ê–ù–î–ù–´–ô –ò–ì–†–û–ö",
            "description": "–¢—ã - –¥—É—à–∞ –∫–æ–º–∞–Ω–¥—ã! –ë–ª–∞–≥–æ–¥–∞—Ä—è —Ç–µ–±–µ –≤–æ–ª–æ–Ω—Ç–µ—Ä—ã —á—É–≤—Å—Ç–≤—É—é—Ç —Å–µ–±—è —Å–µ–º—å–µ–π.",
            "main_skills": ["–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è", "—Ä–∞–±–æ—Ç–∞_–≤_–∫–æ–º–∞–Ω–¥–µ", "—ç–º–ø–∞—Ç–∏—è"],
            "recommendations": "üéÅ –¢–µ–±–µ –ø–æ–¥–æ–π–¥–µ—Ç:\n‚Ä¢ –ü—Ä–æ–≤–µ–¥–µ–Ω–∏–µ —ç–∫—Å–∫—É—Ä—Å–∏–π –∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π\n‚Ä¢ –û–±—â–µ–Ω–∏–µ —Å –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—è–º–∏ –∏ —Å–ø–æ–Ω—Å–æ—Ä–∞–º–∏\n‚Ä¢ –°–æ–∑–¥–∞–Ω–∏–µ –¥—Ä—É–∂–µ—Å–∫–æ–π –∞—Ç–º–æ—Å—Ñ–µ—Ä—ã"
        },
        "–í–Ω–∏–º–∞—Ç–µ–ª—å–Ω—ã–π –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª—å": {
            "type": "üß† –í–ù–ò–ú–ê–¢–ï–õ–¨–ù–´–ô –ù–ê–ë–õ–Æ–î–ê–¢–ï–õ–¨",
            "description": "–¢—ã - –≥–ª–∞–∑–∞ –∏ —É—à–∏ –ø—Ä–∏—é—Ç–∞! –¢—ã –∑–∞–º–µ—á–∞–µ—à—å —Ç–æ, —á—Ç–æ —Å–∫—Ä—ã—Ç–æ –æ—Ç –¥—Ä—É–≥–∏—Ö.",
            "main_skills": ["–≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å", "–∞–Ω–∞–ª–∏–∑", "—Ç–µ—Ä–ø–µ–Ω–∏–µ"],
            "recommendations": "üéÅ –¢–µ–±–µ –ø–æ–¥–æ–π–¥–µ—Ç:\n‚Ä¢ –í–µ–¥–µ–Ω–∏–µ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –¥–Ω–µ–≤–Ω–∏–∫–æ–≤\n‚Ä¢ –ù–∞–±–ª—é–¥–µ–Ω–∏–µ –∑–∞ –ø–æ–≤–µ–¥–µ–Ω–∏–µ–º –Ω–æ–≤—ã—Ö –∂–∏–≤–æ—Ç–Ω—ã—Ö\n‚Ä¢ –ü–æ–º–æ—â—å –≤–µ—Ç–µ—Ä–∏–Ω–∞—Ä—É –≤ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–µ"
        },
        "–û–ø—ã—Ç–Ω—ã–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä": {
            "type": "üéØ –û–ü–´–¢–ù–´–ô –û–†–ì–ê–ù–ò–ó–ê–¢–û–†",
            "description": "–¢—ã - —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Å–æ–ª–¥–∞—Ç –ø—Ä–∏—é—Ç–∞! –¢—ã –¥–µ–ª–∞–µ—à—å –≤—Å–µ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ.",
            "main_skills": ["–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å", "–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å", "–∏–Ω–∏—Ü–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å", "–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è"],
            "recommendations": "üéÅ –¢–µ–±–µ –ø–æ–¥–æ–π–¥–µ—Ç:\n‚Ä¢ –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –≤–æ–ª–æ–Ω—Ç–µ—Ä–æ–≤\n‚Ä¢ –û–±—É—á–µ–Ω–∏–µ –Ω–æ–≤–∏—á–∫–æ–≤\n‚Ä¢ –°–ª–æ–∂–Ω—ã–µ –º–Ω–æ–≥–æ–∑–∞–¥–∞—á–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã"
        },
        "–ù–∞—á–∏–Ω–∞—é—â–∏–π –≤–æ–ª–æ–Ω—Ç–µ—Ä": {
            "type": "üå± –ù–ê–ß–ò–ù–ê–Æ–©–ò–ô –í–û–õ–û–ù–¢–ï–†", 
            "description": "–¢—ã —Ç–æ–ª—å–∫–æ –Ω–∞—á–∏–Ω–∞–µ—à—å —Å–≤–æ–π –ø—É—Ç—å –≤ –≤–æ–ª–æ–Ω—Ç–µ—Ä—Å—Ç–≤–µ! –£ —Ç–µ–±—è –µ—Å—Ç—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª —Ä–∞–∑–≤–∏—Ç—å—Å—è –≤ –ª—é–±–æ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏.",
            "main_skills": [],
            "recommendations": "üéÅ –°–æ–≤–µ—Ç—É–µ–º:\n‚Ä¢ –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ –≤–∏–¥—ã –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏\n‚Ä¢ –£—á–∏—Ç—å—Å—è —É –æ–ø—ã—Ç–Ω—ã—Ö –≤–æ–ª–æ–Ω—Ç–µ—Ä–æ–≤\n‚Ä¢ –ù–µ –±–æ—è—Ç—å—Å—è –∑–∞–¥–∞–≤–∞—Ç—å –≤–æ–ø—Ä–æ—Å—ã"
        }
    }
    
    return descriptions.get(type_name, descriptions["–ù–∞—á–∏–Ω–∞—é—â–∏–π –≤–æ–ª–æ–Ω—Ç–µ—Ä"])